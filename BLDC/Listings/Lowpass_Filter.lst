C251 COMPILER V5.60.0,  Lowpass_Filter                                                     01/03/25  15:57:30  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE Lowpass_Filter
OBJECT MODULE PLACED IN .\Objects\Lowpass_Filter.obj
COMPILER INVOKED BY: D:\mcu\Keil5\C251\BIN\C251.EXE Lowpass_Filter.c XSMALL INTR2 BROWSE DEBUG PRINT(.\Listings\Lowpass_
                    -Filter.lst) OBJECT(.\Objects\Lowpass_Filter.obj) 

stmt  level    source

    1          #include "PWM_Controller.h"
    2          // 卡尔曼滤波器参数
    3          static double x_est = 0;     // 状态估计值
    4          static double p_est = 1;     // 估计误差协方差
    5          static double q = 0.01;      // 过程噪声协方差 较大的值使滤波器更快响应变化，但会
             -增加输出噪声
    6          static double r = 0.1;       // 测量噪声协方差 较大的值表示对测量值的信任度较低，
             -滤波效果更强但响应更慢
    7          static int initialized = 0;  // 初始化标志
    8          
    9          double x_pred;
   10          double p_pred;
   11          double k;
   12          
   13          double Lowpass_Filter(double x)
   14          {
   15   1          // double dt;
   16   1          // dt = timestamp - timestamp_previous;
   17   1      
   18   1          // 第一次调用时，初始化状态
   19   1          if (!initialized) {
   20   2              x_est = x;
   21   2              initialized = 1;
   22   2              return x;
   23   2          }
   24   1      
   25   1          x_pred = x_est;
   26   1          p_pred = p_est + q;
   27   1          
   28   1          k = p_pred / (p_pred + r);
   29   1          x_est = x_pred + k * (x - x_pred);
   30   1          p_est = (1 - k) * p_pred;
   31   1          
   32   1          return x_est;
   33   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       116     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =        30     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =        38     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
